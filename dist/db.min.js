"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};!function(a){function b(a){var b=Object.keys(a).sort();if(1===b.length){var c,d,e=b[0],f=a[e];switch(e){case"eq":c="only";break;case"gt":c="lowerBound",d=!0;break;case"lt":c="upperBound",d=!0;break;case"gte":c="lowerBound";break;case"lte":c="upperBound";break;default:throw new TypeError("`"+e+"` is not valid key")}return[c,[f,d]]}var g=a[b[0]],h=a[b[1]],i=b.join("-");switch(i){case"gt-lt":case"gt-lte":case"gte-lt":case"gte-lte":return["bound",[g,h,"gt"===b[0],"lt"===b[1]]];default:throw new TypeError("`"+i+"` are conflicted keys")}}function c(a){if(a&&"object"===("undefined"==typeof a?"undefined":_typeof(a))&&!(a instanceof d)){var c=b(a),e=_slicedToArray(c,2),f=e[0],g=e[1];return d[f].apply(d,_toConsumableArray(g))}return a}var d=a.IDBKeyRange||a.webkitIDBKeyRange,e={readonly:"readonly",readwrite:"readwrite"},f=Object.prototype.hasOwnProperty,g=function(a){return a},h=a.indexedDB||a.webkitIndexedDB||a.mozIndexedDB||a.oIndexedDB||a.msIndexedDB||a.shimIndexedDB||function(){throw new Error("IndexedDB required")}(),i={},j=["abort","error","versionchange"],k=function(a,b,d,f){var g=this,h=!1;if(this.getIndexedDB=function(){return a},this.isClosed=function(){return h},this.add=function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;c>f;f++)d[f-1]=arguments[f];return new Promise(function(c,f){var g=this;if(h)return void f("Database has been closed");var i=d.reduce(function(a,b){return a.concat(b)},[]),j=a.transaction(b,e.readwrite);j.oncomplete=function(){return c(i,g)},j.onerror=function(a){a.preventDefault(),f(a)},j.onabort=function(a){return f(a)};var k=j.objectStore(b);i.forEach(function(a){var b;if(a.item&&a.key){var c=a.key;a=a.item,b=k.add(a,c)}else b=k.add(a);b.onsuccess=function(b){var c=b.target,d=c.source.keyPath;null===d&&(d="__id__"),Object.defineProperty(a,d,{value:c.result,enumerable:!0})}})})},this.update=function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;c>f;f++)d[f-1]=arguments[f];return new Promise(function(c,f){var g=this;if(h)return void f("Database has been closed");var i=a.transaction(b,e.readwrite);i.oncomplete=function(){return c(k,g)},i.onerror=function(a){return f(a)},i.onabort=function(a){return f(a)};var j=i.objectStore(b),k=d.reduce(function(a,b){return a.concat(b)},[]);k.forEach(function(a){if(a.item&&a.key){var b=a.key;a=a.item,j.put(a,b)}else j.put(a)})})},this.remove=function(b,c){return new Promise(function(d,f){if(h)return void f("Database has been closed");var g=a.transaction(b,e.readwrite);g.oncomplete=function(){return d(c)},g.onerror=function(a){return f(a)},g.onabort=function(a){return f(a)};var i=g.objectStore(b);i["delete"](c)})},this.clear=function(b){return new Promise(function(c,d){if(h)return void d("Database has been closed");var f=a.transaction(b,e.readwrite);f.oncomplete=function(){return c()},f.onerror=function(a){return d(a)},f.onabort=function(a){return d(a)};var g=f.objectStore(b);g.clear()})},this.close=function(){return new Promise(function(c,d){h&&d("Database has been closed"),a.close(),h=!0,delete i[b][f],c()})},this.get=function(b,d){return new Promise(function(e,f){if(h)return void f("Database has been closed");var g=a.transaction(b);g.onerror=function(a){return f(a)},g.onabort=function(a){return f(a)};var i=g.objectStore(b);try{d=c(d)}catch(j){f(j)}var k=i.get(d);k.onsuccess=function(a){return e(a.target.result)}})},this.query=function(b,c){var d=h?"Database has been closed":null;return new l(b,a,c,d)},this.count=function(b,d){return new Promise(function(e,f){if(h)return void f("Database has been closed");var g=a.transaction(b);g.onerror=function(a){return f(a)},g.onabort=function(a){return f(a)};var i=g.objectStore(b);try{d=c(d)}catch(j){f(j)}var k=void 0===d?i.count():i.count(d);k.onsuccess=function(a){return e(a.target.result)}})},this.addEventListener=function(b,c){if(!j.includes(b))throw new Error("Unrecognized event type "+b);a.addEventListener(b,c)},this.removeEventListener=function(b,c){if(!j.includes(b))throw new Error("Unrecognized event type "+b);a.removeEventListener(b,c)},j.forEach(function(a){this[a]=function(b){this.addEventListener(a,b)}},this),!d){var k;return[].some.call(a.objectStoreNames,function(a){if(g[a])return k=new Error('The store name, "'+a+'", which you have attempted to load, conflicts with db.js method names."'),g.close(),!0;g[a]={};var b=Object.keys(g);b.filter(function(a){return![].concat(j,["close","addEventListener","removeEventListener"]).includes(a)}).map(function(b){return g[a][b]=function(){for(var c=arguments.length,d=Array(c),e=0;c>e;e++)d[e]=arguments[e];return g[b].apply(g,[a].concat(d))}})}),k}},l=function(a,c,f,h){var i=this,j=!1,k=function(b,g,h,i,k,l,m){return new Promise(function(n,o){var p=b?d[b].apply(d,_toConsumableArray(g)):null,q=[],r=[p],s=0,t=c.transaction(a,j?e.readwrite:e.readonly);t.oncomplete=function(){return n(q)},t.onerror=function(a){return o(a)},t.onabort=function(a){return o(a)};var u=t.objectStore(a),v=f?u.index(f):u;k=k||null,l=l||[],"count"!==h&&r.push(i||"next");var w=j?Object.keys(j):[],x=function(a){return w.forEach(function(b){var c=j[b];c instanceof Function&&(c=c(a)),a[b]=c}),a};v[h].apply(v,r).onsuccess=function(a){var b=a.target.result;if("number"==typeof b)q=b;else if(b)if(null!==k&&k[0]>s)s=k[0],b.advance(k[0]);else if(null!==k&&s>=k[0]+k[1]);else{var c=!0,d="value"in b?b.value:b.key;l.forEach(function(a){a&&a.length&&(c=2===a.length?c&&d[a[0]]===a[1]:c&&a[0](d))}),c&&(s++,j&&(d=x(d),b.update(d)),q.push(m(d))),b["continue"]()}}})},l=function(a,b,c){var d,e,f,i,l,m="next",n="openCursor",o=[],p=null,q=g,r=!1,s=h||c,t=function(){return s?Promise.reject(s):k(a,b,n,r?m+"unique":m,p,o,q)},u=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return p=b.slice(0,2),1===p.length&&p.unshift(0),{execute:t}},v=function(){return m=null,n="count",{execute:t}},w=function(){return n="openKeyCursor",{desc:e,execute:t,filter:d,distinct:f,map:l}};return d=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return o.push(b.slice(0,2)),{keys:w,execute:t,filter:d,desc:e,distinct:f,modify:i,limit:u,map:l}},e=function(){return m="prev",{keys:w,execute:t,filter:d,distinct:f,modify:i,map:l}},f=function(){return r=!0,{keys:w,count:v,execute:t,filter:d,desc:e,modify:i,map:l}},i=function(a){return j=a,{execute:t}},l=function(a){return q=a,{execute:t,count:v,keys:w,filter:d,desc:e,distinct:f,modify:i,limit:u,map:l}},{execute:t,count:v,keys:w,filter:d,desc:e,distinct:f,modify:i,limit:u,map:l}};["only","bound","upperBound","lowerBound"].forEach(function(a){i[a]=function(){return l(a,arguments)}}),this.range=function(a){var c,d=[null,null];try{d=b(a)}catch(e){c=e}return l.apply(void 0,_toConsumableArray(d).concat([c]))},this.filter=function(){var a=l(null,null);return a.filter.apply(a,arguments)},this.all=function(){return this.filter()}},m=function(a,b,c){if("function"==typeof b&&(b=b()),b&&0!==b.length){for(var d=0;d<c.objectStoreNames.length;d++){var e=c.objectStoreNames[d];b.hasOwnProperty(e)||a.currentTarget.transaction.db.deleteObjectStore(e)}var g;for(g in b){var h,i=b[g];h=!f.call(b,g)||c.objectStoreNames.contains(g)?a.currentTarget.transaction.objectStore(g):c.createObjectStore(g,i.key);var j;for(j in i.indexes){var k=i.indexes[j];try{h.index(j)}catch(l){h.createIndex(j,k.key||j,Object.keys(k).length?k:{unique:!1})}}}}},n=function(a,b,c,d,e){var f=a.target.result;i[b][d]=f;var g=new k(f,b,c,d);return g instanceof Error?Promise.reject(g):Promise.resolve(g)},o={version:"0.14.0",open:function(a){var b=a.server,c=a.version||1;return i[b]||(i[b]={}),new Promise(function(d,e){i[b][c]?n({target:{result:i[b][c]}},b,a.noServerMethods,c,a.schema).then(d,e):!function(){var f=h.open(b,c);f.onsuccess=function(f){return n(f,b,a.noServerMethods,c,a.schema).then(d,e)},f.onupgradeneeded=function(b){return m(b,a.schema,b.target.result)},f.onerror=function(a){return e(a)},f.onblocked=function(d){var g=new Promise(function(d,e){f.onsuccess=function(f){n(f,b,a.noServerMethods,c,a.schema).then(d,e)},f.onerror=function(a){return e(a)}});d.resume=g,e(d)}}()})},"delete":function(a){return new Promise(function(b,c){var d=h.deleteDatabase(a);d.onsuccess=function(a){return b(a)},d.onerror=function(a){return c(a)},d.onblocked=function(a){var b=new Promise(function(b,c){d.onsuccess=function(c){"newVersion"in c||(c.newVersion=a.newVersion),"oldVersion"in c||(c.oldVersion=a.oldVersion),b(c)},d.onerror=function(a){return c(a)}});a.resume=b,c(a)}})},cmp:function(a,b){return h.cmp(a,b)}};"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):a.db=o}(self);
//# sourceMappingURL=db.min.js.map